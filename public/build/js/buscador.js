const dominio="http://localhost";document.addEventListener("DOMContentLoaded",()=>{iniciarApp()});const iniciarApp=()=>{repetidor()},repetidor=()=>{setInterval(()=>{citasAPI(),actualizarCitas()},4e3)};let citasRenderizadas=0;const actualizarCitas=()=>{citasArr.length!=citasRenderizadas&&(citasAPI(),citasRenderizadas=citasArr.length,renderCitas(citasArr))};let citasArr=[];const citasAPI=async()=>{try{const e=dominio+"/api/vercitas",n=await fetch(e),t=await n.json();citasArr.length=0;let a={},i={};idActual=0,t.forEach(e=>{const{id:n,hora:t,cliente:c,email:o,telefono:s,servicio:d,precio:r,fecha:l}=e;idActual!==n&&(a={id:n,cliente:c,telefono:s,email:o,hora:t,fecha:l,servicios:[],total:0},citasArr.push(a),idActual=n),i={servicio:d,precio:r},a.total+=Number(r),a.servicios.push(i)})}catch(e){console.log(e)}},renderCitas=e=>{const n=document.querySelector("#citas");n.innerHTML="",e.forEach(e=>{const{id:t,cliente:a,telefono:i,email:c,fecha:o,hora:s,servicios:d,total:r}=e,l=document.createElement("DIV");l.classList.add("cita");const p=document.createElement("DIV");p.classList.add("cliente-info");const m=document.createElement("P");m.innerHTML="<span>Cita ID:</span> "+t,p.appendChild(m);const h=document.createElement("P");h.innerHTML="<span>Cliente:</span> "+a,p.appendChild(h),l.appendChild(p);const u=document.createElement("DIV");u.classList.add("cita-info");const C=document.createElement("DIV");C.classList.add("contacto-info");const E=document.createElement("P");E.innerHTML="<span>Contacto</span>",C.appendChild(E);const L=document.createElement("P");L.innerHTML="<span>Tel√©fono:</span> "+i,C.appendChild(L);const f=document.createElement("P");f.innerHTML="<span>Email:</span> "+c,C.appendChild(f);const P=document.createElement("P");P.innerHTML="<span>Fecha:</span> "+o,C.appendChild(P);const T=document.createElement("P");T.innerHTML="<span>Hora:</span> "+s,C.appendChild(T);const A=document.createElement("DIV");A.classList.add("servicio-info");const v=document.createElement("P");v.innerHTML="<span>Servicios</span>",A.appendChild(v),d.forEach(e=>{const{servicio:n,precio:t}=e,a=document.createElement("P");a.textContent=n,A.appendChild(a);const i=document.createElement("P");i.innerHTML=`<span>$${t}</span>`,A.appendChild(i)});const H=document.createElement("P");H.innerHTML="<span>Total:</span> $"+r,A.appendChild(H),u.appendChild(C),u.appendChild(A),l.appendChild(u);const M=document.createElement("DIV");M.innerHTML=`<form action="/api/eliminar" method="POST">\n        <input type="hidden" name="id" value="${t}">\n        <input type="submit" value="Eliminar" class="boton-eliminar">\n        </form>`,l.appendChild(M),n.appendChild(l)})};